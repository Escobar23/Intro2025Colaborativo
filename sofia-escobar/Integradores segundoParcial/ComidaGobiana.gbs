/*
los variant se pueden comparar
*/

type ChefGobiano is record {
/* 
PROPÓSITO: Modela un chef de comida gobiana.
*/
field nombre // tipo String
field recetas // tipo Lista de ComidaGobiana
}

type ComidaGobiana is record {
/* PROPÓSITO: Modela una comida que come un gobiano.
INVARIANTES DE REPRESENTACIÓN:
* calorías es un número mayor a cero. */
field nombre // tipo String
field origen // tipo Continente
field calorías // tipo Número
}

type Continente is variant {
/* PROPÓSITO: Modela un continente de donde puede
proceder una comida gobiana. */
case África {}
case América {}
case Asia {}
case Europa {}
case Oceanía {}
}


//Ejercicio 12
function es_MuyLight(chef){
    /*
    SIN TERMINAR
    Proposito: Indica si el chef gobiano *chef* es muy light.
    Precondiciones: Ninguna.
    Parametros: chef: ChefGobiano - el chef a evaluar
    Tipo: Booleano
    Obs: Un chef gobiano es muy light si ninguna de sus recetas es pulenta.
    OBS:
    */
    listaDeRecetas:=recetas(chef)
    while(listaDeRecetas/=[]&&not(calorias(primero(listaDeRecetas))>500)){
        listaDeRecetas:=resto(listaDeRecetas)
    }
    
}

//Ejercicio 11
function simonBolitas(){
    /*
    Proposito: Describe un chef gobiano llamado Simón que tiene como recetas las bolitas de fraile y las bolitas de queso.
    Precondiciones: Ninguna.
    Tipo: ChefGobiano
    */
    return(ChefGobiano(nombre <- "Simón", recetas <- [bolitasDeFraile(), bolitasDeQueso()]));
}    

//Ejercicio 10
function comidasPulentaDe_(listaDeComidas){
    /*
    Proposito: Describe una lista con las comidas gobianas en la lista *listaDeComidas* que son pulentas.
    Precondiciones: Ninguna.
    Parametros: listaDeComidas: Lista de ComidaGobiana - la lista a evaluar
    Tipo: Lista de ComidaGobiana
    Obs: Una comida gobiana es pulenta si tiene mas de 500 calorías.
    */
    listaPulenta:=[]
    foreach comida in listaDeComidas{
        listaPulenta:=listaPulenta ++ singular_Si_(comida, calorías(comida)>500)
    }
    return(listaPulenta)
    */
}


//Ejercicio 9
function comidasDe_Enmantecadas(listaDeComidas){
    /*
    Proposito: Describe una lista con las comidas gobianas en la lista *listaDeComidas* enmantecadas.
    Precondiciones: Ninguna.
    Parametros: listaDeComidas: Lista de ComidaGobiana - la lista a evaluar
    Tipo: Lista de ComidaGobiana
    Obs: Utiliza la función comida_enmantecada.
    */
    listaEnmantecada:=[]
    foreach comida in listaDeComidas{
        listaEnmantecada:=listaEnmantecada ++ [comida_enmantecada(comida)]
    }
    return(listaEnmantecada)
}


//Ejercicio 8
function cantidadDeCaloriasDe_(listaDeComidas){
    /*
    Proposito: Describe la cantidad total de calorías de las comidas gobianas en la lista *listaDeComidas*.
    Precondiciones: Ninguna.
    Parametros: listaDeComidas: Lista de ComidaGobiana - la lista a evaluar
    Tipo: Número
    Obs: x
    */
    totalCalorias:=0
    foreach comida in listaDeComidas{
        totalCalorias:=totalCalorias + calorías(comida)
    }
    return(totalCalorias)
}


//Ejercicio 7
function hayUnaBolitaDeFraileEn_(listaDeComidas){
    /*
    CREO QUE ESTA MAL
    Proposito: Indica si en la lista de comidas gobianas *listaDeComidas* hay al menos una bolita de fraile.
    Precondiciones: Ninguna.
    Parametros: listaDeComidas: Lista de ComidaGobiana - la lista a evaluar
    Tipo: Booleano
    Obs: Es un recorrido de búsqueda sobre la lista, buscando una bolita de fraile.
    */
    comidaActual:=primeraDe_(listaDeComidas)
    while(comidaActual/=ultimaDe_(listaDeComidas)&&not(esBolitaDeFraile_(comidaActual))){
        comidaActual:=siguienteDe_(comidaActual, listaDeComidas)
    }
    return(esBolitaDeFraile_(comidaActual))

}


//Ejercicio 6
function albondigueada(){
    /*
    MAL
    Proposito: Describe una lista con comidas gobianas que representa a la albondigueada.
    Precondiciones: Ninguna.
    Tipo: Lista de ComidaGobiana
    */
    albondigueadaPorAhora:=[ComidaGobiana(nombre<-"Albóndigas", origen<-Europa, calorías<-700)]
    repeat(4){
        albondigueadaPorAhora:=[ComidaGobiana(nombre<-"Albóndigas", origen<-Europa, 
        calorías<-(calorías(primero(albondigueadaPorAhora))-100))]++albondigueadaPorAhora
    }

    
}

//Ejercicio 5
function comida_enmantecada(comida){
    /*
    Proposito: Describe una comida gobiana que representa a la comida gobiana *comida* enmantecada.
    Precondiciones: Ninguna.
    Parametros: comida: ComidaGobiana - la comida a enmantecar
    Tipo: ComidaGobiana
    Obs: La comida enmantecada tiene 200 calorías más que la comida original.
    */
    //funcion modificadora
    return(ComidaGobiana(comida | calorías <- calorías(comida)+200));
}

//Ejercicio 4
function proviene_De_(comida, continente){
    /*
    Proposito: Indica si la comida gobiana *comida* proviene del continente *continente*.
    Precondiciones: Ninguna.
    Parametros: comida: ComidaGobiana - la comida a evaluar
                continente: Continente - el continente a evaluar
    Tipo: Booleano
    */
    return(origen(comida) == continente);

}

//Ejercicio 3
function comidaMásSaludableEntre_Y_(comida1, comida2){
    /*
    Proposito: Describe la comida gobiana más saludable entre las comidas gobianas *comida1* y *comida2*, si son igual de saludables devuelve la primera.
    Precondiciones: Ninguna.
    Parametros: comida1: ComidaGobiana - la primera comida a comparar
                comida2: ComidaGobiana - la segunda comida a comparar
    Tipo: ComidaGobiana
    Obs: la comida mas saludable es la que tiene menos calorías.
    */
    return(choose comida1 when(not(tiene_MásCaloriasQue_(comida1, comida2)))
        comida2 otherwise)
}

//Ejercicio 2
function tiene_MásCaloriasQue_(comida1, comida2){
    /*
    Propostio: Indica si la comida gobiana *comida1* tiene más calorías que la comida gobiana *comida2*.
    Precondiciones: Ninguna.
    Parametros: comida1: ComidaGobiana - la primera comida a comparar
                comida2: ComidaGobiana - la segunda comida a comparar
    Tipo: Booleano
    */
    return(calorías(comida1)>calorías(comida2));
}

//Ejercicio 1 a y b
function bolitasDeFraile(){
    /*
    Proposito: Describe una comida gobiana que representa a las bolitas de fraile.
    Precondiciones: Ninguna.
    Tipo: ComidaGobiana
    */
    return(ComidaGobiana(nombre <- "Bolita de Fraile", origen <- América, calorías <- 500));
}

function bolitasDeQueso(){
    /*
    Proposito: Describe una comida gobiana que representa a las bolitas de queso.
    Precondiciones: Ninguna.
    Tipo: ComidaGobiana
    */
    return(ComidaGobiana(nombre <- "Bolita de Queso", origen <- Europa, calorías <- 150));
}